<h1><%= form_name %></h1>

<% model.stations.ordered.each do |station| %>
  <%= form_tag update_position_station_path(station), method: :patch do %>
    <%= station.name %>
    <%= number_field_tag :position, station.position_in(@route), class: "tutu-field tutu-field--number" %>
    <%= hidden_field_tag :route_id, @route.id %>
    <%= submit_tag "Изменить", class: "tutu-button" %>
  <% end %>
<% end %>

<%= form_with model: model, local: true do |f| %>
  <%= render 'components/error_block', item: model %>

  <%= render 'components/table',
             caption: ["Имя", "Поезд", "Станции"] do %>
    <div class="tutu-table__row tutu-table__row--body">
      <%= table_cell f.text_field(:name, class: "tutu-field") %>
      <%= render "components/form_checkbox_cell",
                 form: f,
                 main_method: :train_ids,
                 collection: Train.all,
                 value_method: :id,
                 text_method: :number %>
      <%= render "components/form_checkbox_cell",
                 form: f,
                 main_method: :station_ids,
                 collection: Station.all,
                 value_method: :id,
                 text_method: :name %>
    </div>
  <% end %>

  <%= content_tag :div do %>
    <%= f.submit form_button, class: "tutu-button" %>
  <% end %>
<% end %>
